#!/usr/bin/env bash

# Run without downloading:
# curl https://raw.githubusercontent.com/kaykayehnn/dotfiles/master/.macos | bash

# Install homebrew
/usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"

# Packages are declared as alphabetically sorted arrays with one item per line
# for the following reasons:
# 1. Better git diffs
# 2. Easier manual scanning when using a list command. That is, when executing
#    `{npm, brew} list`, finding missing packages is O(n) instead of O(n^2)

BREW_PACKAGES=(
  bat
  gist
  git
  gpg2
  gnupg
  htop
  httpie
  hub
  mas
  mysql@5.7
  node
  pinentry-mac
  trash
  tree
  wget
  yarn
)

BREW_CASK_PACKAGES=(
  alfred
  atom
  bettertouchtool
  betterzip
  disk-inventory-x
  firefox
  flux
  font-fira-code
  google-chrome
  handbrake
  iina
  kap
  macs-fan-control
  mactracker
  mysqlworkbench
  postman
  qlcolorcode
  qlimagesize
  qlmarkdown
  qlstephen
  qlvideo
  quicklook-json
  spotify
  # TODO: remove when Catalina comes out?
  usage
  visual-studio-code
)

NPM_GLOBAL_PACKAGES=(
  create-react-app
  fx
  gatsby-cli
  jest
  netlify-cli
  nodemon
  prettier
  serve@^6
  source-map-explorer
  typescript
  webpack-bundle-analyzer
)

OMZ_PLUGINS=(
# Fish-like fast/unobtrusive autosuggestions for zsh.
  zsh-users/zsh-autosuggestions
# Fish shell-like syntax highlighting for Zsh.
  zsh-users/zsh-syntax-highlighting
# Additional completion definitions for Zsh.
  zsh-users/zsh-completions
)

# Install brew packages
brew install ${BREW_PACKAGES[@]}

# Add fonts repository to brew sources
brew tap caskroom/fonts

# Install brew cask apps
brew cask install ${BREW_CASK_PACKAGES[@]}

# Install npm packages
npm install --global ${NPM_GLOBAL_PACKAGES[@]}

# Install Oh-My-ZSH
sh -c "$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)"

# Install OMZ plugins
for plugin in "${OMZ_PLUGINS[@]}"
do
  git clone "https://github.com/$plugin" "${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/$(basename $plugin)"
done
